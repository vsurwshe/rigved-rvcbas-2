<div id="page-loading" [hidden]="!loading">
    <div class="loader">
        <img src="assets/img/giphy.gif" width="100" height="100" style="padding: 0">
    </div>
</div>
<div class="col-md-12 table-responsive header-board">
    <div class="tab">
        <button id="defaultOpen" class="tablinks" (click)="openTab($event, 'UpcomingRides')">Upcoming Rides</button>
        <button class="tablinks" (click)="openTab($event, 'PastRides')">Past Rides</button>
        <button type="button" class="button-small" style="cursor: pointer" (click)="goToAddTrip()" > <span class="myfont">ADD TRIP</span> </button>
    </div>
    <div id="UpcomingRides" class="tabcontent">
        <div class="col-sm-12">
            <table id="upComeingDataTable" class="display" style="width: 100%;"></table>
        </div>
    </div>
    <div id="PastRides" class="tabcontent">
        <div class="col-sm-12">
            <table id="pastRidesDataTable" class="display" style="width: 100%;"></table>
        </div>
    </div>
</div>
<!-- Model Code -->
<!-- This model showing view trip model -->
<div class="modal" tabindex="-1" role="dialog" id="exampleModal">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Ride Details -View</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-4">
                        <label><h6 class="text">Company:</h6></label>
                        <label class="subtext">&nbsp;{{ridesDetails?.companyDetailDto?.companyName}}</label>
                    </div>
                    <div class="col-md-2">
                        <label><h6 class="text">Travel Id:</h6></label>
                        <label class="subtext">&nbsp;{{ridesDetails?.travelId}}</label>
                    </div>
                    <div class="col-md-2">
                        <label> <h6 class="text">Date:</h6></label>
                        <label class="subtext">&nbsp;{{ridesDetails?.pickUpDate}}</label>
                    </div>
                    <div class="col-md-2">
                        <label><h6 class="text">Time:</h6></label>
                        <label class="subtext">&nbsp;{{ridesDetails?.pickUpTime}}</label>
                    </div>
                </div>
                <hr>
                <div class="row">
                    
                    <div class="col-md-6">
                        <h6 class="text">Traveller Details</h6>
                        <div class="col-md-3">
                            <img class="img" src="assets/img/dummy.png" alt="img">
                        </div>
                        <div class="col-md-9 element">
                            <label><h6 class="text">Name :</h6></label>
                            <label class="subtext">&nbsp;&nbsp;{{ridesDetails?.travelerDetailDto?.firstName}}{{ridesDetails?.travelerDetailDto?.lastName}}</label><br>
                            <label><h6 class="text">Mobile Number :</h6></label>
                            <label class="subtext">&nbsp;&nbsp;{{ridesDetails?.travelerDetailDto?.mobileNumber}}</label><br>
                            <label><h6 class="text">Employee Id :</h6></label>
                            <label class="subtext">{{ridesDetails?.travelerDetailDto?.employeeId}}</label><br>
                        </div>
                        <hr>
                        <label><h6 class="text">Vehicle segment/type :</h6></label>
                        <label class="subtext">&nbsp;&nbsp;{{ridesDetails?.sysCarCategoryDto?.name}}</label><br>
                        <label><h6 class="text">Travel Date :</h6></label>
                        <label class="subtext">&nbsp;&nbsp;{{ridesDetails?.pickUpDate}}</label><br>
                        <label><h6 class="text">Pick-up city :</h6></label>
                        <label class="subtext">&nbsp;&nbsp;{{ridesDetails?.pickUpCity}}</label><br>
                        <label><h6 class="text">Pick-up location :</h6></label>
                        <label class="subtext">&nbsp;&nbsp;{{ridesDetails?.pickUpLocation}}</label><br>
                        <label><h6 class="text">pick-up address :</h6></label>
                        <label class="subtext">&nbsp;&nbsp;{{ridesDetails?.pickUpAddress}}</label><br>
                    </div>
                    <div class="col-md-6">
                        <h6 class="text">Driver Details</h6>
                        <div class="col-md-3">
                            <img class="img" src="assets/img/dummy.png" alt="img">
                        </div>
                        <div class="col-md-9 element">
                            <label><h6 class="text">Name :</h6></label> 
                            <label class="subtext">&nbsp;&nbsp;{{ridesDetails?.driverDetailDto?.firstName}}&nbsp;{{ridesDetails?.driverDetailDto?.lastName}}</label><br>
                            <label><h6 class="text">Mobile Number :</h6></label>
                            <label class="subtext">&nbsp;&nbsp;{{ridesDetails?.driverDetailDto?.mobileNumber}}</label><br>
                            <label><h6 class="text">Brand/modal :</h6></label>
                            <label class="subtext">&nbsp;&nbsp;{{ridesDetails?.sysCarCategoryDto?.name}}</label><br>
                        </div>
                        <hr>
                        <label><h6 class="text">Type of request :</h6></label>
                        <label class="subtext"> &nbsp;&nbsp;{{ridesDetails?.sysBookingRequestTypeDto?.name}}</label><br>
                        <label><h6 class="text">Pick-up Time :</h6></label>
                        <label class="subtext">&nbsp;&nbsp;{{ridesDetails?.pickUpTime}}</label><br>
                        <label><h6 class="text">Release Time :</h6></label>
                        <label class="subtext">&nbsp;&nbsp;{{ridesDetails?.dropTime}}</label><br>
                        <label><h6 class="text">Release location :</h6></label>
                        <label class="subtext">&nbsp;&nbsp;{{ridesDetails?.releaseLocation}}</label><br>
                        <label><h6 class="text">Release address :</h6></label>
                        <label class="subtext">&nbsp;&nbsp;{{ridesDetails?.releaseAddress}}</label><br>
                    </div>
                </div>
                <hr>
                <div class="text-center" [hidden]="!view">
                    <label>Current Ride Status</label><br>
                    <div *ngIf="ridesDetails?.totalDistance">
                        <label>Total Distance: {{ridesDetails?.totalDistance}}</label>&nbsp;&nbsp;
                        <label>Total Time: {{ridesDetails?.totalTime}}</label>&nbsp;&nbsp;
                    </div>
                    
                    <button class="btn btn-defualt">
                        <h2>{{ridesDetails?.changedStatus}}</h2>
                    </button>
                </div>
                <div class="text-center" style="padding-top: 10px;" [hidden]="!feedback">
                    <button class="btn btn-defualt" (click)="viewTripDetails(ridesDetails)" data-toggle="modal" data-target="#tripDetailsModel" >View Trip Details</button>
                    <button class="btn btn-defualt" (click)="viewFeedback(ridesDetails)" data-toggle="modal" data-target="#feedbackModel" >View Feedback</button> 
                </div>
                <div class="text-center" [hidden]="!accept">
                    <label>Current Ride Status</label><br>
                    <button class="btn btn-success" ng-click="acceptRide(ridesDetails)">
                        <h2 style="color: #fff;">Accept</h2>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- This model showing reassign model -->
<div class="modal" tabindex="-1" role="dialog" id="exampleModal1">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Reassign Trip</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-6">
                        <h6 class="text">Traveller Details</h6>
                        <div class="col-md-3">
                            <img class="img" src="assets/img/dummy.png" alt="img">
                        </div>
                        <div class="col-md-9 element">
                            <label ><h6 class="text">Name :</h6></label>
                            <label class="subtext">&nbsp;&nbsp;{{ridesDetails?.travelerDetailDto?.firstName}}&nbsp;{{ridesDetails?.travelerDetailDto?.lastName}}</label><br>
                            <label><h6 class="text">Mobile Number :</h6></label>
                            <label class="subtext">&nbsp;&nbsp;{{ridesDetails?.travelerDetailDto?.mobileNumber}}</label><br>
                            <label><h6 class="text">Employee Id :</h6></label>
                            <label class="subtext">{{ridesDetails?.travelerDetailDto?.employeeId}}</label><br>
                        </div>
                        <hr>
                        <label><h6 class="text">Vehicle segment/type :</h6></label>
                        <label class="subtext">&nbsp;&nbsp;{{ridesDetails?.sysCarCategoryDto?.name}}</label><br>
                        <label><h6 class="text">Travel Date :</h6></label>
                        <label class="subtext">&nbsp;&nbsp;{{ridesDetails?.pickUpDate}}</label><br>
                        <label><h6 class="text">Pick-up city :</h6></label>
                        <label class="subtext">&nbsp;&nbsp;{{ridesDetails?.pickUpCity}}</label><br>
                        <label><h6 class="text">Pick-up location :</h6></label>
                        <label class="subtext">&nbsp;&nbsp;{{ridesDetails?.pickUpLocation}}</label><br>
                        <label><h6 class="text">pick-up address :</h6></label>
                        <label class="subtext">&nbsp;&nbsp;{{ridesDetails?.pickUpAddress}}</label><br>
                    </div>
                    <div class="col-md-6">
                        <h6 class="text">Driver Details</h6>
                        <div class="col-md-3">
                            <img class="img" src="assets/img/dummy.png" alt="img">
                        </div>
                        <div class="col-md-9 element">
                            <label> <h6 class="text">Name :</h6> </label> 
                            <label class="subtext">&nbsp;&nbsp;{{ridesDetails?.travelerDetailDto?.firstName}}&nbsp;{{ridesDetails?.travelerDetailDto?.lastName}}</label><br>
                            <label><h6 class="text">Mobile Number :</h6></label>
                            <label class="subtext">&nbsp;&nbsp;{{ridesDetails?.travelerDetailDto?.mobileNumber}}</label><br>
                            <label><h6 class="text">Brand/modal :</h6></label>
                            <label class="subtext">&nbsp;&nbsp;{{ridesDetails?.sysCarCategoryDto?.name}}</label><br>
                        </div>
                        <hr>
                        <label><h6 class="text">Type of request :</h6> </label>
                        <label class="subtext"> &nbsp;&nbsp;{{ridesDetails?.sysBookingRequestTypeDto?.name}}</label><br>
                        <label> <h6 class="text">Pick-up Time :</h6> </label>
                        <label class="subtext">&nbsp;&nbsp;{{ridesDetails?.pickUpTime}}</label><br>
                        <label><h6 class="text">Release Time :</h6></label>
                        <label class="subtext">&nbsp;&nbsp;{{ridesDetails?.dropTime}}</label><br>
                        <label> <h6 class="text">Release location :</h6></label>
                        <label class="subtext">&nbsp;&nbsp;{{ridesDetails?.releaseLocation}}</label><br>
                        <label><h6 class="text">Release address :</h6></label>
                        <label class="subtext">&nbsp;&nbsp;{{ridesDetails?.releaseAddress}}</label><br>
                    </div>
                </div>
                <hr>
                <div class="col-md-12 text-right">
                    <h4 class="mt-2 mb-2">Assign Ride</h4>
                    <ul style="right: 50%;display:inline-flex;">
                        <li>
                            <label class="switch">
                                <input type="checkbox" checked ng-model="online" (click)="ToggleOnline(online)">
                                <span class="slider round"></span>
                            </label>
                        </li>
                        <li class="online-status myfont" [hidden]="online" ng-show="online">
                            <span> Auto</span>
                        </li>
                        <li class="offline-status myfont" [hidden]="!online">
                            <span> Manual</span>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="from-group select col-sm-6" [hidden]="online">
                <!-- <lable for="">Select a Driver</lable>
                <input class="form-control txt-field " placeholder="Enter For Use" ng-model="driver"
                    uib-typeahead="company as company.name for company in getDriverList($viewValue)"
                    typeahead-loading="loadingLocations" typeahead-show-hint="false" typeahead-min-length="0"
                    typeahead-no-results="noResults" class="form-control" ng-focus=getDriverList()>
                <i ng-show="loadingLocations" class="glyphicon glyphicon-refresh"></i>
                <div ng-show="noResults">
                    <i class="glyphicon glyphicon-remove"></i> No Results Found
                </div> -->
            </div>
            <div class="col-sm-12" style="margin-top: 10px;position: relative;bottom: 15px;">
                <!-- <center> -->
                    <button type="button" class="button btn-block" (click)="reAssignRide(ridesDetails)">Assign Ride</button>
                <!-- </center> -->
            </div>
        </div>
    </div>
</div>
<!-- This model showing customer feedback model -->
<div class="modal" tabindex="-1" role="dialog" id="feedbackModel">
    <div class="modal-dialog modal-md" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Customer Feedback</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="center">
                    <ngb-rating [(rate)]="starReatings" [max]="5" [readonly]="true" style="font-size: 30px; color: #F7CC1A;"></ngb-rating>
                    <div class="from-group  col-sm-12">
                        <label>Message</label><br/>
                         <label>{{feedbackMessage}}</label> 
                    </div>
                </div>
            </div> 
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

 <!-- This model showing trip details -->
 <div class="modal" tabindex="-1" role="dialog" id="tripDetailsModel">
    <div class="modal-dialog modal-md" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Trip Details</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <ng-container *ngIf="tripData != null; else elseTemplate">
                    <app-trip-details [tripData]="tripData"></app-trip-details>
                </ng-container>
                <ng-template #elseTemplate>
                    <label>There is no trip details for this ride.</label>
                </ng-template>
            </div> 
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>